(function(){var t={}.hasOwnProperty,e=function(e,n){function r(){this.constructor=e}for(var i in n)t.call(n,i)&&(e[i]=n[i]);return r.prototype=n.prototype,e.prototype=new r,e.__super__=n.prototype,e};define(["jquery","backbone","uuid"],function(t,n){var r,i,o,u,l,p,s,c,a;return o=function(t){function n(){return p=n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.defaults={title:"",url:"",thumb_url:"",caption:"",slug:"",group_id:"",description:""},n.prototype.sync=function(){return!1},n.prototype.initialize=function(){return _.bindAll(this)},n}(n.Model),u=function(t){function n(){return s=n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.tagName="figure",n.prototype.render=function(){return this.el.innerHTML='<a class="fancybox" rel="'+this.model.get("group_id")+'" href="'+this.model.get("url")+'" title="'+this.model.get("title")+'">\n	<img src="'+this.model.get("thumb_url")+'" alt="" />\n	<figcaption>'+this.model.get("title")+"</figcaption>\n</a>"},n.prototype.initialize=function(){return _.bindAll(this),this.model.view=this,this.render()},n}(n.View),i=function(t){function n(){return c=n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.className="gallery",n.prototype.initialize=function(){return _.bindAll(this)},n}(n.View),r=function(t){function n(){return a=n.__super__.constructor.apply(this,arguments)}return e(n,t),n.prototype.model=o,n.prototype.added_photo=function(t){return t.set("group_id",this.group_id),this.view.$el.append(new u({model:t}).el)},n.prototype.initialize=function(){return _.bindAll(this),this.group_id=Math.uuid(),this.on("add",this.added_photo),this.view=new i({model:this})},n}(n.Collection),l=function(){var e;return e=[],t(".gallery").each(function(n,i){return e[n]=new r,t(i).find("a").each(function(){var r,i;return i=t(this).attr("href"),r=attachment_index[i],e[n].add({title:r.title,url:i,thumb_url:r.images.thumbnail.url,caption:r.caption,description:r.description,slug:r.slug})}).promise().done(function(){return t(i).replaceWith(e[n].view.el)})})}})}).call(this);